/*
 * Copyright (C) 2009-2022 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/fin/travel/lib/reuse/util/FragmentHelper","sap/fin/travel/lib/reuse/util/i18n","sap/fin/travel/lib/reuse/util/CustomDataUtil","sap/fin/travel/lib/reuse/util/PersistenceHelper","sap/fin/travel/lib/reuse/util/ODataModelUtil","sap/fin/travel/lib/reuse/util/NavigationUtil","sap/fin/travel/lib/reuse/util/ControlUtil","fin/travel/mytravelexpensesv2/util/CreditCardUtil","sap/m/MessageBox","sap/ui/model/Context"],function(J,F,a,b,I,C,P,O,N,c,d,M,e){"use strict";return sap.ui.controller("fin.travel.mytravelexpensesv2.controller.ListPageExtension",{onInit:function(){$.noop();},_fnDraftOrUnsavedByDialog:function(o,D){var i=D&&D.getProperty("DraftLinkType")==="Draft";var f=D&&D.getProperty("DraftLinkType")==="UnsavedBy";var s=D&&D.getProperty("Tripno");if(i){var A=I.get().getText(this,"LEAVE_PAGE");M.show(I.get().getText(this,"BACK_WARNING"),{icon:M.Icon.WARNING,title:I.get().getText(this,"WARNING"),actions:[A,M.Action.CANCEL],onClose:function(j){if(j===A&&o&&"function"===typeof o){o();}}});}else if(f){var g=D.getProperty("DraftUserId");var h=this.getView().getId()+"UnsavedChangesDialogFragment";b.get().getUnsavedDialog(this,h,s,g).then(o);}else if(o&&"function"===typeof o){o();}},handleCreateExpenseConfirm:function(E){var o=E.getSource().getBindingContext().getObject();var s=sap.ui.getCore().byId("CreateExpenseDialogFragment--schemaSmartField");if(s&&$.isEmptyObject(s.getValue())){this.oCreateExpenseDialog.getModel("createExpenseDialogModel").setProperty("/stripMessage",I.get().getText(this,"SCHEMA_MISSING_FIELD_ALERT"));}else{this.oCreateExpenseDialog.getModel("createExpenseDialogModel").setProperty("/stripMessage","");var m=this.getView().getModel();m.deleteCreatedEntry(new e(m,this.oCreateExpenseDialog.getBindingContext().getPath()));var t=this;var S=function(D,r){var f="/"+(r.headers&&r.headers["location"]&&r.headers["location"].split("/").slice(-1).pop())||"TravelExpenses(Pernr='"+D.Pernr+"',Tripno='"+D.Tripno+"')";t.oCreateExpenseDialog.close();N.navigate(f,t.getOwnerComponent().iLevel);};P.createEntry(m,"TravelExpenses",{success:S,properties:{Pernr:o.Pernr,Tripno:o.Tripno,TSchema:o.TSchema}});}},handleSchemaChange:function(E){if(!$.isEmptyObject(E.getParameter("value"))){this.oCreateExpenseDialog.getModel("createExpenseDialogModel").setProperty("/stripMessage","");}},handleCreateExpenseCancel:function(E){this.oCreateExpenseDialog.getModel("createExpenseDialogModel").setProperty("/stripMessage","");var s=sap.ui.getCore().byId("CreateExpenseDialogFragment--schemaSmartField");var p=sap.ui.getCore().byId("CreateExpenseDialogFragment--pendingTripListSmartField");s.setValue("");p.setValue("");this.oCreateExpenseDialog.close();},handleCreditCard:function(E){var l=c.getSmartTable(E.getSource());var D=O.get().getDraftItem(l);var s=D&&D.getProperty("Tripno");d.viewCreditCard(E,this,true,s);}});});
